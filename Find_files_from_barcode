'''
Created on 24/2/2016
This script will take an eve input file and copy all the fe files that were repaired (the input files not the output files) into a directory of choice 
@author: ajones7
'''
import os
import fnmatch
import shutil
import glob
# file containing list of arrays to import
list_of_arrays_file=open('S:\\Genetics_Data2\\Array\\Audits and Projects\\150108 Aled dissertation\\eve\\eve_input.txt','r')

# empty array for list of filenames to add
filename_string=[]

#loop through the file containing desired arrays. 
for i, line in enumerate(list_of_arrays_file):
    line = line.split("\t")
    barcode1=line[0]
    subarray1=line[1]
    barcode2=line[3]
    subarray2=line[4]
    abberation=line[6]

    # convert the subarray number into the file name. convert into a integer. 
    if int(subarray1) == 1:
        #assign to arraycoord the desired end to the filename. use ? as wildcard character
        arraycoord1="1?1.txt"
    elif int(subarray1) == 2:
        arraycoord1="1?2.txt"
    elif int(subarray1) == 3:
        arraycoord1="1?3.txt"
    elif int(subarray1) == 4:
        arraycoord1="1?4.txt"
    elif int(subarray1) == 5:
        arraycoord1="2?1.txt"
    elif int(subarray1) == 6:
        arraycoord1="2?2.txt"
    elif int(subarray1) == 7:
        arraycoord1="2?3.txt"
    elif int(subarray1) == 8:
        arraycoord1="2?4.txt"
    else:
        print "error in subarray 1"
        
# convert the subarray number into the file name. convert into a integer. 
    if int(subarray2) == 1:
        #assign to arraycoord the desired end to the filename. use ? as wildcard character
        arraycoord2="1?1.txt"
    elif int(subarray2) == 2:
        arraycoord2="1?2.txt"
    elif int(subarray2) == 3:
        arraycoord2="1?3.txt"
    elif int(subarray2) == 4:
        arraycoord2="1?4.txt"
    elif int(subarray2) == 5:
        arraycoord2="2?1.txt"
    elif int(subarray2) == 6:
        arraycoord2="2?2.txt"
    elif int(subarray2) == 7:
        arraycoord2="2?3.txt"
    elif int(subarray2) == 8:
        arraycoord2="2?4.txt"
    else:
        print "error in subarray 2"
        
    # create the search term for the file using barcode something (*) arraycoord and append to the list of filenames.
    filename_string.append(str(barcode1)+'_S01*'+arraycoord1)
    filename_string.append(str(barcode2)+'_S01*'+arraycoord2)
    
print len(filename_string)
uniquefiles=set(filename_string)
print len(uniquefiles)

#define the folder containing the array files
array_dir='S:\\Genetics_Data2\\Array\\FeatureExtraction'
#define folder that the array files are to be copied to
destination='S:\\Genetics_Data2\\Array\\Audits and Projects\\150108 Aled dissertation\\prospective'

# #for each filename in the list and for each file in the directory of arrays if these match copy the file into the destination folder  
for i in uniquefiles:
    #print i
    for file in os.listdir(array_dir):
        if fnmatch.fnmatch(file, i):
            print "file found:"+file
            shutil.copy2(array_dir+"\\"+file,destination)
print "copy complete"
 
#check copy

for i in filename_string:
    if glob.glob1(destination,i) is False:
        print i
print "all files present in destination"
